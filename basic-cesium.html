<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Cesium - No External Tiles</title>
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        #cesiumContainer {
            width: 100%;
            height: 600px;
            border: 2px solid #333;
            background: #87CEEB;
        }
        #status {
            padding: 15px;
            margin: 10px 0;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸŒ æœ€åŸºæœ¬Cesiumï¼ˆå¤–éƒ¨ã‚¿ã‚¤ãƒ«ä¸ä½¿ç”¨ï¼‰</h1>
    <div id="status" class="info">åˆæœŸåŒ–ä¸­...</div>
    <div id="cesiumContainer"></div>

    <script>
        const statusDiv = document.getElementById('status');

        function updateStatus(message, type = 'info') {
            statusDiv.textContent = message;
            statusDiv.className = type;
            console.log(`[${new Date().toLocaleTimeString()}] ${message}`);
        }

        // ç’°å¢ƒæƒ…å ±
        updateStatus('ç’°å¢ƒç¢ºèªä¸­...', 'info');
        console.log('URL:', window.location.href);
        console.log('Protocol:', window.location.protocol);
        console.log('Cesium version:', Cesium.VERSION);

        try {
            // Cesium Ion ã‚’å®Œå…¨ã«ç„¡åŠ¹åŒ–
            Cesium.Ion.defaultAccessToken = '';
            console.log('Cesium Ion disabled');

            updateStatus('Cesiumãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ã‚’ä½œæˆä¸­ï¼ˆèƒŒæ™¯ãªã—ï¼‰...', 'info');

            // å¤–éƒ¨ã‚¿ã‚¤ãƒ«ã‚’ä¸€åˆ‡ä½¿ã‚ãªã„æœ€å°æ§‹æˆ
            const viewer = new Cesium.Viewer('cesiumContainer', {
                imageryProvider: false,  // èƒŒæ™¯ç”»åƒã‚’ç„¡åŠ¹åŒ–
                terrainProvider: false,  // åœ°å½¢ã‚’ç„¡åŠ¹åŒ–
                skyBox: false,          // ã‚¹ã‚«ã‚¤ãƒœãƒƒã‚¯ã‚¹ã‚’ç„¡åŠ¹åŒ–
                skyAtmosphere: false,   // å¤§æ°—ã‚’ç„¡åŠ¹åŒ–
                baseLayerPicker: false,
                geocoder: false,
                homeButton: true,
                sceneModePicker: false,
                navigationHelpButton: false,
                animation: false,
                timeline: false,
                fullscreenButton: false,
                vrButton: false
            });

            // èƒŒæ™¯è‰²ã‚’è¨­å®š
            viewer.scene.backgroundColor = Cesium.Color.LIGHTSTEELBLUE;
            viewer.scene.globe.show = false;  // åœ°çƒã‚’éè¡¨ç¤º

            updateStatus('âœ… ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ä½œæˆå®Œäº†ï¼', 'success');

            // æ±äº¬ä¸Šç©ºã«ç§»å‹•
            viewer.camera.setView({
                destination: Cesium.Cartesian3.fromDegrees(139.767, 35.681, 50000),
                orientation: {
                    heading: 0.0,
                    pitch: -Math.PI / 4,  // 45åº¦ä¸‹å‘ã
                    roll: 0.0
                }
            });

            updateStatus('âœ… åŸºæœ¬è¡¨ç¤ºå®Œäº†ï¼ï¼ˆé’ã„èƒŒæ™¯ã§3Dç©ºé–“ã‚’è¡¨ç¤ºï¼‰', 'success');

            // ç°¡å˜ãªãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãƒ†ã‚¹ãƒˆ
            viewer.entities.add({
                name: 'æ±äº¬é§…',
                position: Cesium.Cartesian3.fromDegrees(139.767, 35.681, 0),
                point: {
                    pixelSize: 20,
                    color: Cesium.Color.YELLOW,
                    outlineColor: Cesium.Color.BLACK,
                    outlineWidth: 2,
                    heightReference: Cesium.HeightReference.CLAMP_TO_GROUND
                },
                label: {
                    text: 'æ±äº¬é§…',
                    font: '16pt sans-serif',
                    fillColor: Cesium.Color.WHITE,
                    outlineColor: Cesium.Color.BLACK,
                    outlineWidth: 2,
                    style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                    pixelOffset: new Cesium.Cartesian2(0, -50)
                }
            });

            updateStatus('âœ… å®Œäº†ï¼æ±äº¬é§…ãƒãƒ¼ã‚«ãƒ¼ã‚’è¡¨ç¤ºä¸­', 'success');

            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            viewer.cesiumWidget.screenSpaceEventHandler.setInputAction(function(click) {
                const pickedObject = viewer.scene.pick(click.position);
                if (pickedObject && pickedObject.id) {
                    updateStatus(`ã‚¯ãƒªãƒƒã‚¯: ${pickedObject.id.name}`, 'info');
                }
            }, Cesium.ScreenSpaceEventType.LEFT_CLICK);

        } catch (error) {
            updateStatus('âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
            console.error('è©³ç´°ã‚¨ãƒ©ãƒ¼:', error);
            
            document.getElementById('cesiumContainer').innerHTML = 
                `<div style="padding: 40px; text-align: center; color: #721c24;">
                    <h3>åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼</h3>
                    <p>${error.message}</p>
                    <p><small>ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„</small></p>
                </div>`;
        }
    </script>
</body>
</html>
